const weatherStore = new Map();
const WEATHER_PATTERNS = [
  {
    name: "Neon Monsoon",
    ascii: `
███╗   ██╗███████╗ ██████╗ ███╗   ██╗
████╗  ██║██╔════╝██╔═══██╗████╗  ██║
██╔██╗ ██║█████╗  ██║   ██║██╔██╗ ██║
██║╚██╗██║██╔══╝  ██║   ██║██║╚██╗██║
██║ ╚████║███████╗╚██████╔╝██║ ╚████║
╚═╝  ╚═══╝╚══════╝ ╚═════╝ ╚═╝  ╚═══╝
                                     
███╗   ███╗ ██████╗ ███╗   ██╗       
████╗ ████║██╔═══██╗████╗  ██║       
██╔████╔██║██║   ██║██╔██╗ ██║       
██║╚██╔╝██║██║   ██║██║╚██╗██║       
██║ ╚═╝ ██║╚██████╔╝██║ ╚████║       
╚═╝     ╚═╝ ╚═════╝ ╚═╝  ╚═══╝       
                                     
███████╗ ██████╗  ██████╗ ███╗   ██╗ 
██╔════╝██╔═══██╗██╔═══██╗████╗  ██║ 
███████╗██║   ██║██║   ██║██╔██╗ ██║ 
╚════██║██║   ██║██║   ██║██║╚██╗██║ 
███████║╚██████╔╝╚██████╔╝██║ ╚████║ 
╚══════╝ ╚═════╝  ╚═════╝ ╚═╝  ╚═══╝ `,
    effect: "+20% Cyberpsychosis Risk",
    drink: "Blue Lotus Iced Coffee"
  },
  {
    name: "Data Storm",
    ascii: `
██████╗  █████╗ ████████╗ █████╗             
██╔══██╗██╔══██╗╚══██╔══╝██╔══██╗            
██║  ██║███████║   ██║   ███████║            
██║  ██║██╔══██║   ██║   ██╔══██║            
██████╔╝██║  ██║   ██║   ██║  ██║            
╚═════╝ ╚═╝  ╚═╝   ╚═╝   ╚═╝  ╚═╝            
                                             
███████╗████████╗ ██████╗ ██████╗ ███╗   ███╗
██╔════╝╚══██╔══╝██╔═══██╗██╔══██╗████╗ ████║
███████╗   ██║   ██║   ██║██████╔╝██╔████╔██║
╚════██║   ██║   ██║   ██║██╔══██╗██║╚██╔╝██║
███████║   ██║   ╚██████╔╝██║  ██║██║ ╚═╝ ██║
╚══════╝   ╚═╝    ╚═════╝ ╚═╝  ╚═╝╚═╝     ╚═╝`,
    effect: "-30% System Stability",
    drink: "Encryption Mint Tea"
  },
  {
    name: "Quantum Fog",
    ascii: `
 ██████╗ ██╗   ██╗ █████╗ ███╗   ██╗
██╔═══██╗██║   ██║██╔══██╗████╗  ██║
██║   ██║██║   ██║███████║██╔██╗ ██║
██║▄▄ ██║██║   ██║██╔══██║██║╚██╗██║
╚██████╔╝╚██████╔╝██║  ██║██║ ╚████║
 ╚══▀▀═╝  ╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═══╝
                                    
████████╗██╗   ██╗███╗   ███╗       
╚══██╔══╝██║   ██║████╗ ████║       
   ██║   ██║   ██║██╔████╔██║       
   ██║   ██║   ██║██║╚██╔╝██║       
   ██║   ╚██████╔╝██║ ╚═╝ ██║       
   ╚═╝    ╚═════╝ ╚═╝     ╚═╝       
                                    
███████╗ ██████╗  ██████╗           
██╔════╝██╔═══██╗██╔════╝           
█████╗  ██║   ██║██║  ███╗          
██╔══╝  ██║   ██║██║   ██║          
██║     ╚██████╔╝╚██████╔╝          
╚═╝      ╚═════╝  ╚═════╝            `,
    effect: "±15% Reality Perception",
    drink: "Superposition Cold Brew"
  },
  {
    name: "Static Surge",
    ascii: `
███████╗████████╗ █████╗ ████████╗██╗ ██████╗
██╔════╝╚══██╔══╝██╔══██╗╚══██╔══╝██║██╔════╝
███████╗   ██║   ███████║   ██║   ██║██║     
╚════██║   ██║   ██╔══██║   ██║   ██║██║     
███████║   ██║   ██║  ██║   ██║   ██║╚██████╗
╚══════╝   ╚═╝   ╚═╝  ╚═╝   ╚═╝   ╚═╝ ╚═════╝
                                             
███████╗██╗   ██╗██████╗  ██████╗ ███████╗   
██╔════╝██║   ██║██╔══██╗██╔════╝ ██╔════╝   
███████╗██║   ██║██████╔╝██║  ███╗█████╗     
╚════██║██║   ██║██╔══██╗██║   ██║██╔══╝     
███████║╚██████╔╝██║  ██║╚██████╔╝███████╗   
╚══════╝ ╚═════╝ ╚═╝  ╚═╝ ╚═════╝ ╚══════╝   `,
    effect: "+25% Interface Lag",
    drink: "Overclocked Espresso"
  },
  {
    name: "Hologram Aurora",
    ascii: `
██╗  ██╗ ██████╗ ██╗      ██████╗                 
██║  ██║██╔═══██╗██║     ██╔═══██╗                
███████║██║   ██║██║     ██║   ██║                
██╔══██║██║   ██║██║     ██║   ██║                
██║  ██║╚██████╔╝███████╗╚██████╔╝                
╚═╝  ╚═╝ ╚═════╝ ╚══════╝ ╚═════╝                 
                                                  
 ██████╗ ██████╗  █████╗ ███╗   ███╗              
██╔════╝ ██╔══██╗██╔══██╗████╗ ████║              
██║  ███╗██████╔╝███████║██╔████╔██║              
██║   ██║██╔══██╗██╔══██║██║╚██╔╝██║              
╚██████╔╝██║  ██║██║  ██║██║ ╚═╝ ██║              
 ╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═╝╚═╝     ╚═╝              
                                                  
 █████╗ ██╗   ██╗██████╗  ██████╗ ██████╗  █████╗ 
██╔══██╗██║   ██║██╔══██╗██╔═══██╗██╔══██╗██╔══██╗
███████║██║   ██║██████╔╝██║   ██║██████╔╝███████║
██╔══██║██║   ██║██╔══██╗██║   ██║██╔══██╗██╔══██║
██║  ██║╚██████╔╝██║  ██║╚██████╔╝██║  ██║██║  ██║
╚═╝  ╚═╝ ╚═════╝ ╚═╝  ╚═╝ ╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═╝`,
    effect: "+35% Sensor Overload",
    drink: "Prism Soda"
  },
  {
    name: "Nano Tornado",
    ascii: `
███╗   ██╗ █████╗ ███╗   ██╗ ██████╗ 
████╗  ██║██╔══██╗████╗  ██║██╔═══██╗
██╔██╗ ██║███████║██╔██╗ ██║██║   ██║
██║╚██╗██║██╔══██║██║╚██╗██║██║   ██║
██║ ╚████║██║  ██║██║ ╚████║╚██████╔╝
╚═╝  ╚═══╝╚═╝  ╚═╝╚═╝  ╚═══╝ ╚═════╝ 
                                     
████████╗ ██████╗ ██████╗            
╚══██╔══╝██╔═══██╗██╔══██╗           
   ██║   ██║   ██║██████╔╝           
   ██║   ██║   ██║██╔══██╗           
   ██║   ╚██████╔╝██║  ██║           
   ╚═╝    ╚═════╝ ╚═╝  ╚═╝           
                                     
███╗   ██╗ █████╗ ██████╗  ██████╗   
████╗  ██║██╔══██╗██╔══██╗██╔═══██╗  
██╔██╗ ██║███████║██║  ██║██║   ██║  
██║╚██╗██║██╔══██║██║  ██║██║   ██║  
██║ ╚████║██║  ██║██████╔╝╚██████╔╝  
╚═╝  ╚═══╝╚═╝  ╚═╝╚═════╝  ╚═════╝   `,
    effect: "-40% Hardware Integrity",
    drink: "Nanite Colada"
  },
  {
    name: "Plasma Haze",
    ascii: `
██████╗ ██╗      █████╗ ███████╗███╗   ███╗ █████╗ 
██╔══██╗██║     ██╔══██╗██╔════╝████╗ ████║██╔══██╗
██████╔╝██║     ███████║███████╗██╔████╔██║███████║
██╔═══╝ ██║     ██╔══██║╚════██║██║╚██╔╝██║██╔══██║
██║     ███████╗██║  ██║███████║██║ ╚═╝ ██║██║  ██║
╚═╝     ╚══════╝╚═╝  ╚═╝╚══════╝╚═╝     ╚═╝╚═╝  ╚═╝
                                                   
██╗  ██╗ █████╗ ███████╗███████╗                   
██║  ██║██╔══██╗╚══███╔╝██╔════╝                   
███████║███████║  ███╔╝ █████╗                     
██╔══██║██╔══██║ ███╔╝  ██╔══╝                     
██║  ██║██║  ██║███████╗███████╗                   
╚═╝  ╚═╝╚═╝  ╚═╝╚══════╝╚══════╝                   `,
    effect: "+18% Optical Distortion",
    drink: "Photon Lemonade"
  }
];

export function getCurrentWeather(guildId) {
  return weatherStore.get(guildId) || WEATHER_PATTERNS[0];
}

export async function rotateWeather(guild) {
  const randomIndex = Math.floor(Math.random() * WEATHER_PATTERNS.length);
  const newWeather = WEATHER_PATTERNS[randomIndex];

  weatherStore.set(guild.id, newWeather);
  guild.weatherLastUpdated = Date.now();
  return newWeather;
}